--- 
title: "GRAFICOS CON DATOS"
author: "Luis Alberto Solis Peña"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib, packages.bib]
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
  This is a minimal example of using the bookdown package to write a book.
  The HTML output format for this example is bookdown::gitbook,
  set in the _output.yml file.
link-citations: yes
github-repo: LASPUMSS/GRAFICOS-CON-DATOS
---

# Presentación {-}

Se presentan los gráficos más usados en el análisis de datos, como ser:

- Gráficos de dispersión.
- Gráficos de barras.
- Gráficos de líneas.
- Histogramas.
- Gráficos de cajas.

```{r include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE,
                      out.width = "50%",
                      out.height = "50%",
                      fig.align = "center")

# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```


<!--chapter:end:index.Rmd-->

# (PART) FUNDAMENTOS {-}

# Introducción
Los graficos en el proceso de analisis de datos, son el primer acercamiento con los datos, nos permiten darnos una idea de como se estan comportando estos y reconocer patrones que saltan a la vista como una tendencia o agrupamiento, que despues se ratificara o rechazar empleando modelos mas precisos. Es por esto y mucho mas, que debemos darnos un tiempo prudente en el estudio de los gráficos, y sus mejores practicas.

## Conceptos

### Variable
La idea mas general que uno puede hacer al pensar en una variable, es asociarla con algo que **cambia**


<!--chapter:end:cap/Rmarkdown/fund/01-fund-intro.Rmd-->

# Grafico de disperción 
El grafico de diesperión, nos permite representar la relación entre dos variables continuas.

## Librerias necesarias

```{r, message=FALSE, warning=FALSE}
library(reticulate)
library(ggplot2)
library(dplyr)
```

```{python}
import numpy as np
import matplotlib.pyplot as plt
```

## Grafico de dispercion con R

```{r, out.width="50%", out.height="50%", fig.align='center'}
cars %>% ggplot(aes(x=speed,y=dist)) + geom_point()

```

## Grafico de disperción con Python

```{python, out.width="50%", out.height="50%", fig.align='center'}
plt.clf()
x=np.array(r.cars["speed"])
y=np.array(r.cars["dist"])

plt.scatter(x,y)
plt.show()
```


<!--chapter:end:cap/Rmarkdown/fund/02-fund-grafico-dispersion.Rmd-->

# Grafico De Barras
Los graficos de barras son utilizado comunmente para representar variables discretas o cualitativas.

## Librerias necesarias

```{r}
library(gcookbook)
library(reticulate)
library(ggplot2)
library(dplyr)
```

```{python}
import numpy as np
import matplotlib.pyplot as plt
```

## Grafico de barras con R


```{r}
pg_mean %>% ggplot(aes(x=group, y=weight)) + 
    geom_col()
```

## Grafico de barras con Python
```{python}
plt.clf()
x=np.array(r.pg_mean["group"])
y=np.array(r.pg_mean["weight"])

plt.bar(x,y)
plt.show()

```


<!--chapter:end:cap/Rmarkdown/fund/03-fund-grafico-de-barras.Rmd-->

# Grafico De Lineas

Los graficos de lineas nos permiten ver la evolución de una variable atravez del tiempo que es como generalmente se lo utilizar el grafico de lineas.


## Librerias necesarias

```{r}
library(gcookbook)
library(reticulate)
library(ggplot2)
library(dplyr)
```

```{python}
import numpy as np
import matplotlib.pyplot as plt
```

## Grafico de lineas en R

```{r}
BOD %>%  ggplot(aes(x=Time, y=demand)) + 
    geom_line()
```

## Grafico de lineas en Python 
```{python}
plt.clf()
x=np.array(r.BOD["Time"])
y=np.array(r.BOD["demand"])

plt.plot(x,y)
plt.show()

```



<!--chapter:end:cap/Rmarkdown/fund/04-fund-grafico-de-lineas.Rmd-->

# Histograma
Los histogramas se los utiliza comúnmente para visualizar la forma en se distribuyen los datos.

## Librerias necesarias

```{r}
library(gcookbook)
library(reticulate)
library(ggplot2)
library(dplyr)
```

```{python}
import numpy as np
import matplotlib.pyplot as plt
```

## Histograma en R

```{r}

cars %>% ggplot(aes(x=dist)) + 
    geom_histogram()

```

## Hisograma en Python

```{python}
plt.clf()

x=np.array(r.cars["dist"])

plt.hist(x)
plt.show()
```


<!--chapter:end:cap/Rmarkdown/fund/05-fund-histograma.Rmd-->

# Grafico de caja
Los grafico de caja son utilizados para resumir de forma visual un conjunto de datos, los máximos, mínimos, mediana y cuartiles.

## Librerias necesarias

```{r}
library(gcookbook)
library(reticulate)
library(ggplot2)
library(dplyr)
```

```{python}
import numpy as np
import matplotlib.pyplot as plt
```

## Grafico de caja en R

```{r}

cars %>% ggplot(aes(y=dist)) + 
    geom_boxplot()

```


## Grafico de caja en Python

```{python}
plt.clf()

x=np.array(r.cars["dist"])

plt.boxplot(x)
plt.show()

```


<!--chapter:end:cap/Rmarkdown/fund/06-fund-grafico-de-caja.Rmd-->

# Nube de palabras
Las nubes de palabras nos permiten visualizar la frecuencia con la que se repite, para poder graficar este tipo de gráficos se necesita dos variables, una que representa las "palabras" y  la otra variable que representa su "frecuencia". Dentro del análisis de datos con R existen paquetes que guardan este tipo de datos.

## Librerias necesarias

```{r}
library(janeaustenr)
library(tidytext)
library(dplyr)
library(stringr)
library(wordcloud)
```

## Preparación de los datos
```{r}
books <- austen_books() %>%
    group_by(book) %>%
    mutate(linenumber = row_number(),
           chapter = cumsum(str_detect(text,regex("^chapter [\\divxlc]",ignore_case =TRUE)))) %>%
    ungroup()

data("stop_words")
books_words <- books %>%
    unnest_tokens(word, text) %>% anti_join(stop_words)

```

## Nube de letras

```{r, out.width="80%", out.height="80%"}

books_words %>%
  count(word, sort = TRUE) %>%
  with(wordcloud(word, n, max.words = 100))

```


<!--chapter:end:cap/Rmarkdown/fund/07-fund-nube-de-palabras.Rmd-->

# (PART) PERSONALIZACIONES {-}

# Introducción
Si bien ya sabemos como generar un grafico, es hora de ver los destalles que puede hacer mas informativo de un grafico, como agregar facetas, y otros que hacen mas **informativo** a un grafico.

1. Anotaciones
1. Ejes
1. Temas
1. Legendas
1. Facetas
1. Colores en parcelas

<!--chapter:end:cap/Rmarkdown/perso/01-perso-intro.Rmd-->

# Anotaciones
Las anotaciones nos permiten dar mas información a los usuarios de grafico, esto es subjetivo, deacuerdo a la audiencia a la que esta dirigida los grafico.


```{r}
library(reticulate)
library(gcookbook)
library(ggplot2)
library(dplyr)
```

```{r}
p <- cars %>% ggplot(aes(x=speed, y=dist)) +
  geom_point()

p +
  annotate("text", x = 10, y = 50, label = "Grupo 1") +
  annotate("text", x = 23, y = 100, label = "Grupo 2")
```







<!--chapter:end:cap/Rmarkdown/perso/02-perso-anotaciones.Rmd-->

# Ejes


```{r}
library(reticulate)
library(gcookbook)
library(ggplot2)
library(dplyr)
```

```{r}
ggplot(cars, aes(x = speed, y = dist)) +
  geom_boxplot()

ggplot(cars, aes(x = speed, y = dist)) +
  geom_boxplot() +
  coord_flip()
```


<!--chapter:end:cap/Rmarkdown/perso/03-perso-ejes.Rmd-->

# Temas

```{r}
library(reticulate)
library(gcookbook)
library(ggplot2)
library(dplyr)
```

## Crear el gráfico base
```{r}

hw_plot <- cars %>%  ggplot(aes(x = speed, y = dist)) +
  geom_point()

```

## Tema por defecto
```{r}

hw_plot +
  theme_grey()

```

## Tema blanco y negro
```{r}

hw_plot +
  theme_bw()

```

## Tema minimal
```{r}

hw_plot +
  theme_minimal()

```

## Tema clasico
```{r}
hw_plot +
  theme_classic()
```



<!--chapter:end:cap/Rmarkdown/perso/04-perso-temas.Rmd-->

# Leyendas

```{r}
library(reticulate)
library(gcookbook)
library(ggplot2)
library(dplyr)
```

```{r}
pg_plot <- ggplot(CO2, aes(x = conc, y = uptake, fill = Plant)) +
  geom_boxplot() +
  scale_fill_brewer(palette = "Pastel2")

pg_plot +
  theme(legend.position = "top")
```


<!--chapter:end:cap/Rmarkdown/perso/05-perso-leyendas.Rmd-->

# Facetas
Las facetas tienen por objeto segmentar gráficos, en función de una variable categórica.

```{r}
library(reticulate)
library(gcookbook)
library(ggplot2)
library(dplyr)
```

## Crear el gráfico base
```{r}
CO2_plot <- ggplot(CO2, aes(x = conc, y = uptake)) +
  geom_point()

```


## Crear facetas horizontales
```{r}
CO2_plot +
  facet_grid(. ~ Type)

```

## Crear facetas verticales
```{r}
CO2_plot +
 facet_grid(Treatment ~ .)

```

## Crear facetas con doble entrada
```{r}
CO2_plot +
 facet_grid(Treatment ~ Type)
```

<!--chapter:end:cap/Rmarkdown/perso/06-perso-facetas.Rmd-->

# Colores

```{r}
library(reticulate)
library(gcookbook)
library(ggplot2)
library(dplyr)
```

```{r}
ggplot(cars, aes(x = dist)) +
  geom_histogram(fill = "red", colour = "black")

ggplot(cars, aes(x = speed, y = dist)) +
  geom_point(colour = "red")
```



<!--chapter:end:cap/Rmarkdown/perso/07-perso-colores.Rmd-->

# (PART) DATOS {-}

# Introducción
En esta sección se presentara la ficha tecnica de los marcos de datos que se utilizan en el libro, describiendo el contextos de base de datos y significado de cada variable.



<!--chapter:end:cap/Rmarkdown/data/01-data-intro.Rmd-->

# Coches

## Descripción

Los datos corresponden a la velocidad de los automóviles y las distancias necesarias para detenerse.teniendo en cuenta que los datos se registraron en la década de 1920.

## Variables

### Speed 
Variable numerica, que represeneta la velocidad que ejerce en coche en millas por hora.


### dist
Varibale numerica, que representa la distancia que necesito para detenerce en pies.

### n
El tamaño de data es de `r round(nrow(cars),0)` observaciones.

## Fuente
Ezekiel, M. (1930) Métodos de análisis de correlación. Wiley.


## Datos

```{r, echo=FALSE}

knitr::kable(
    cars, longtable = TRUE, booktabs = TRUE,
    caption = 'Velocidad y distancias de frenado de los automóviles.'
)
```


<!--chapter:end:cap/Rmarkdown/data/02-data-coches.Rmd-->

